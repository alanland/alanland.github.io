(window.webpackJsonp=window.webpackJsonp||[]).push([[108],{791:function(e,a,t){"use strict";t.r(a);var r=t(6),s=Object(r.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[e._v("使用Tomcat之后，遇到了下面一个报错：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v(" org.apache.coyote.http11.Http11Processor.service Error parsing HTTP request header\n Note: further occurrences of HTTP header parsing errors will be logged at DEBUG level.\n java.lang.IllegalArgumentException: Invalid character found in the request target. The valid characters are defined in RFC 7230 and RFC 3986\n        at org.apache.coyote.http11.Http11InputBuffer.parseRequestLine(Http11InputBuffer.java:472)\n        at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:683)\n        at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)\n        at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)\n        at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\n        at java.lang.Thread.run(Thread.java:745)\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br")])]),t("p",[e._v("stackoverflow上面发现了这样一个回答：")]),e._v(" "),t("p",[e._v("This behavior is introduced in all major Tomcat releases:")]),e._v(" "),t("ul",[t("li",[e._v("Tomcat 7.0.73, 8.0.39, 8.5.7")])]),e._v(" "),t("p",[e._v("For a quick fix, you can downgrade to one of older versions.")]),e._v(" "),t("p",[e._v("Based on "),t("a",{attrs:{href:"https://tomcat.apache.org/tomcat-8.5-doc/changelog.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("changelog"),t("OutboundLink")],1),e._v(", those changes could affect this behavior:")]),e._v(" "),t("p",[e._v("Tomcat 8.5.3:")]),e._v(" "),t("blockquote",[t("p",[e._v("Ensure that requests with HTTP method names that are not tokens (as required by RFC 7231) are rejected with a 400 response\nTomcat 8.5.7:")])]),e._v(" "),t("blockquote",[t("p",[e._v("Add additional checks for valid characters to the HTTP request line parsing so invalid request lines are rejected sooner.\nBut eventually you want to encode your URL on client:")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('encodeURI("http://localhost:8080/app/handleResponse?msg=name|id|")\n> http://localhost:8080/app/handleResponse?msg=name%7Cid%7C\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("or just query string:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('encodeURIComponent("msg=name|id|")\n> msg%3Dname%7Cid%7C\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("It will secure you from other problematic characters (list of invalid URI characters).")]),e._v(" "),t("p",[e._v("另一种解决方法：")]),e._v(" "),t("p",[e._v("Since "),t("code",[e._v("Tomcat 7.0.76, 8.0.42, 8.5.12")]),e._v(" you can define property "),t("RouterLink",{attrs:{to:"/blogs/2017/05/https//tomcat.apache.org/tomcat-8.5-doc/config/systemprops.html"}},[e._v("requestTargetAllow")]),e._v("\nto allow forbiden characters.")],1),e._v(" "),t("p",[e._v("Add this line in your "),t("code",[e._v("catalina.properties")])]),e._v(" "),t("div",{staticClass:"language-properties line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token attr-name"}},[e._v("tomcat.util.http.parser.HttpParser.requestTargetAllow")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[e._v("|{}")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("hr"),e._v(" "),t("p",[e._v("参考： http://stackoverflow.com/questions/41053653/tomcat-8-is-not-able-to-handle-get-request-with-in-query-parameters")]),e._v(" "),t("hr"),e._v(" "),t("p",[e._v("END")])])}),[],!1,null,null,null);a.default=s.exports}}]);