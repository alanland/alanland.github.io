(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{812:function(s,a,e){"use strict";e.r(a);var t=e(6),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[e("a",{attrs:{href:"http://docs.ansible.com/ansible/become.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("文档"),e("OutboundLink")],1)]),s._v(" "),e("p",[s._v("http://docs.ansible.com/ansible/playbooks.html")]),s._v(" "),e("p",[s._v("http://docs.ansible.com/ansible/intro_configuration.html#ask-sudo-pass")]),s._v(" "),e("p",[s._v("http://docs.ansible.com/ansible/playbooks_intro.html")]),s._v(" "),e("h2",{attrs:{id:"inventory"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#inventory"}},[s._v("#")]),s._v(" inventory")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("test"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n192.168.95.114   ansible_user=host\n192.168.95.115   ansible_user=host\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"playbook"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#playbook"}},[s._v("#")]),s._v(" playbook")]),s._v(" "),e("p",[e("code",[s._v("nginx-install.yml")])]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hosts")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" test\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("become")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yes\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("become_user")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("become_method")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" su\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("roles")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("role")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n     "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nginx_http_params")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sendfile on"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"access_log /var/log/nginx/access.log"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"command"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#command"}},[s._v("#")]),s._v(" command")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ ansible-playbook -i hosts nginx-install.yml --become -K -vvv\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[s._v("#")]),s._v(" 说明")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("--ask-become-pass, -K\n \task for privilege escalation password, does not imply become will be used\n--become, -b\trun operations with become (no password implied)\n--become-method=BECOME_METHOD\n \tprivilege escalation method to use (default=sudo), valid choices: [ sudo | su | pbrun | pfexec | doas | dzdo | ksu ]\n--become-user=BECOME_USER\n \trun operations as this user (default=root), does not imply –become/-b\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h2",{attrs:{id:"错误"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#错误"}},[s._v("#")]),s._v(" 错误")]),s._v(" "),e("blockquote",[e("p",[s._v('"Timeout (12s) waiting for privilege escalation prompt:')])]),s._v(" "),e("p",[s._v("参考 "),e("a",{attrs:{href:"https://stackoverflow.com/questions/21870083/specify-sudo-password-for-ansible",target:"_blank",rel:"noopener noreferrer"}},[s._v("Specify sudo password for Ansible"),e("OutboundLink")],1)]),s._v(" "),e("h3",{attrs:{id:"命令行方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#命令行方式"}},[s._v("#")]),s._v(" 命令行方式")]),s._v(" "),e("p",[s._v("当:")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("become_method")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sudo\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("ansible-playbook playbook.yml -i inventory.ini --user"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username --extra-vars "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ansible_sudo_pass=yourPassword"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("当:")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("become_method")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" su\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("ansible-playbook playbook.yml -i inventory.ini --user"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username --extra-vars "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ansible_su_pass=yourPassword"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"配置方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置方式"}},[s._v("#")]),s._v(" 配置方式")]),s._v(" "),e("p",[s._v("Inventory file:")]),s._v(" "),e("div",{staticClass:"language-ini line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-ini"}},[e("code",[e("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[test]")]),s._v("\n192.168.95.152  ansible_user"),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("host ansible_ssh_pass=host ansible_su_pass=host")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("hr"),s._v(" "),e("p",[s._v("END")])])}),[],!1,null,null,null);a.default=n.exports}}]);