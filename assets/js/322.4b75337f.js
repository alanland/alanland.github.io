(window.webpackJsonp=window.webpackJsonp||[]).push([[322],{1038:function(s,a,t){"use strict";t.r(a);var n=t(6),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("业务需要，今天来弄一个反人类的东西 "),t("strong",[s._v("ldap")]),s._v("，不想解释，他就是这么反人类。")]),s._v(" "),t("h2",{attrs:{id:"服务端安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务端安装"}},[s._v("#")]),s._v(" 服务端安装")]),s._v(" "),t("p",[s._v("用 docker 安装， openldap 和管理工具 phpldapadmin :")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("openldap")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" osixia/openldap"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.2.5\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" openldap\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hostname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" openldap\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("LDAP_TLS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("LDAP_ORGANISATION")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" example\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("LDAP_DOMAIN")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" example.com\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("LDAP_ADMIN_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" admin\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 2389"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("389")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 2636"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("636")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("phpldapadmin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" osixia/phpldapadmin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("0.8.0\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" phpldapadmin\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("PHPLDAPADMIN_LDAP_HOSTS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" openldap\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("PHPLDAPADMIN_HTTPS")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'false'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 6443"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" openldap\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")])]),t("h2",{attrs:{id:"登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#登录"}},[s._v("#")]),s._v(" 登录")]),s._v(" "),t("p",[s._v("访问 http://host:6443 ，点击登录：")]),s._v(" "),t("p",[s._v("输入用户名：没错下面这么一堆就是用户名：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("cn")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admin,dc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("example,dc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("com\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("和你配置的密码。")]),s._v(" "),t("h2",{attrs:{id:"管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#管理"}},[s._v("#")]),s._v(" 管理")]),s._v(" "),t("p",[s._v("根据网上文章的指导")]),s._v(" "),t("p",[s._v("先要建立两个 "),t("code",[s._v("organizationalUnit")]),s._v(" ，一个叫作 "),t("code",[s._v("groups")]),s._v("  ，一个叫作 "),t("code",[s._v("users")])]),s._v(" "),t("p",[t("code",[s._v("groups")]),s._v(" 下创建 objectClass 为 "),t("code",[s._v("groupOfNames")]),s._v(" 的 group，")]),s._v(" "),t("p",[t("code",[s._v("users")]),s._v(" 下创建 "),t("code",[s._v("child entry")]),s._v(" ，选择 "),t("code",[s._v("default")]),s._v(" 了类型， object class 为 "),t("code",[s._v("inetOrgPerson")]),s._v("，")]),s._v(" "),t("p",[s._v("然而我在点击创建的时候毫无反应。。。")]),s._v(" "),t("p",[s._v("看了两个后台的日志，没有特别的输出，先用默认用户吧。")]),s._v(" "),t("h2",{attrs:{id:"你猜都猜不到的名称"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#你猜都猜不到的名称"}},[s._v("#")]),s._v(" 你猜都猜不到的名称")]),s._v(" "),t("ul",[t("li",[s._v("c: Country")]),s._v(" "),t("li",[s._v("dc: Domain Component\n"),t("ul",[t("li",[s._v("example.com 会变成 dc=example,dc=com")])])]),s._v(" "),t("li",[s._v("uid: User id\n"),t("ul",[t("li",[s._v("一条记录的 id")])])]),s._v(" "),t("li",[s._v("o: Organization")]),s._v(" "),t("li",[s._v("ou:  Organization Unit")]),s._v(" "),t("li",[s._v("cn: Common Name")]),s._v(" "),t("li",[s._v("sn: Surname")]),s._v(" "),t("li",[s._v("dn: Distinguished Name\n"),t("ul",[t("li",[s._v("唯一位置： uid=alan.wong,ou=dev,dc=example,dc=com")])])]),s._v(" "),t("li",[s._v("rdn: Relative dn")])]),s._v(" "),t("h2",{attrs:{id:"springboot-集成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#springboot-集成"}},[s._v("#")]),s._v(" SpringBoot 集成")]),s._v(" "),t("p",[s._v("gradle:")]),s._v(" "),t("div",{staticClass:"language-groovy line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-groovy"}},[t("code",[s._v("compile "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'org.springframework.boot:spring-boot-starter-data-ldap'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("application.yml")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ldap")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ldap://192.168.1.1:389"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("base")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" DC=example"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("DC=com\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("userDn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"administrator@example.com"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("userPwd")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("referral")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" follow\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("domainName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%s@example.com"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("hr"),s._v(" "),t("ul",[t("li",[s._v("https://segmentfault.com/a/1190000014683418")])])])}),[],!1,null,null,null);a.default=e.exports}}]);