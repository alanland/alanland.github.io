(window.webpackJsonp=window.webpackJsonp||[]).push([[248],{957:function(s,a,t){"use strict";t.r(a);var n=t(6),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("有尝试过用"),t("code",[s._v("shell")]),s._v("执行"),t("code",[s._v("nohup")]),s._v("命令，测试了几种方式都失败，比如：")]),s._v(" "),t("ul",[t("li",[s._v("平时\b的运行方式"),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Start daemon\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shell")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nohup myexeprogram arg1 arg2 &\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])]),s._v(" "),t("li",[s._v("Stackoverflow上: "),t("a",{attrs:{href:"https://stackoverflow.com/questions/39347379/ansible-run-command-on-remote-host-in-background",target:"_blank",rel:"noopener noreferrer"}},[s._v("ansible run command on remote host in background"),t("OutboundLink")],1),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hosts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" centos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("target\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gather_facts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" no\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tasks")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shell")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"(cd /; python -mSimpleHTTPServer >/dev/null 2>&1 &)"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("async")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("poll")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" start simple http server in background\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shell")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" cd /tmp/www; nohup python "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mSimpleHTTPServer </dev/null "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("/dev/null 2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token important"}},[s._v("&1")]),s._v(" &\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])]),s._v(" "),t("p",[s._v("最终找到解释，使用"),t("code",[s._v("&")]),s._v("执行程序并不会让程序成为deamon，只是后台运行，包括nohup一样。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("如果程序是C程序，可以调用"),t("code",[s._v("daemon()")]),s._v("方法。")])]),s._v(" "),t("li",[t("p",[s._v("其他程序可以使用 "),t("a",{attrs:{href:"http://libslack.org/daemon/manpages/daemon.1.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("daemon"),t("OutboundLink")],1),s._v(" 程序来实现")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Start daemon\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shell")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" daemon "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" myexeprogram arg1 arg2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/html/deployment-install.html#deployment-service",target:"_blank",rel:"noopener noreferrer"}},[s._v("Springboot作为服务运行"),t("OutboundLink")],1),s._v("中的方案，测试后启动失败，可能还差了什么吧。")]),s._v(" "),t("h3",{attrs:{id:"as-init-d-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#as-init-d-service"}},[s._v("#")]),s._v(" As init.d service")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v(" -s /var/myapp/myapp.jar /etc/init.d/myapp\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s ~/myproject/build/libs/myapp-1.0.jar /etc/init.d/myapp_servicename\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("then:")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("/etc/init.d/myapp start\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"as-a-systemd-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#as-a-systemd-service"}},[s._v("#")]),s._v(" As a systemd service")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[Unit]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Description")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("myapp")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("After")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("syslog.target")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[Service]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("/var/myapp/myapp.jar")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[Install]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WantedBy")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("multi-user.target")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("hr"),s._v(" "),t("p",[s._v("Links:")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://stackoverflow.com/questions/29806673/daemonizing-an-executable-in-ansible",target:"_blank",rel:"noopener noreferrer"}},[s._v("Daemonizing an executable in ansible"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);